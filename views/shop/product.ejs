<%- include('../includes/navbar') %>
<meta name="title" content="<%= product.meta_title %>" />
<meta name="description" content="<%= product.meta_description %>" />
<div class="row justify-content-center mx-auto mt-3">
  <div class="col-sm-12 col-md-11 col-lg-10">
    <div class="text-center"><%- include('../includes/messages') %></div>
    <div class="card border-light mb-3">
      <div class="row justify-content-center text-center">
        <% for( let i = 0; i < product.photos.length; i++ ) {%>
        <div class="col-sm-10 col-md-5 mb-3">
          <a
            data-toggle="lightbox"
            data-gallery="gallery"
            href="/files/<%= product.photos[i].filename %>"
          >
            <img
              src="/files/<%= product.photos[i].filename %>"
              class="d-block w-100"
              alt="<%= product.photos[i].fileID %>"
            />
          </a>
        </div>
        <% } %>
      </div>
      <div class="card-body">
        <p class="card-title" style="font-size: x-large; font-weight: bolder;">
          <%= product.title %>
          <span class="text-info"><%= product.code %></span>
        </p>
        <p class="card-subtitle mb-1"><%= product.description %></p>
        <div class="float-right">
          <%- include('../includes/save') %> <%- include('../includes/like') %>
        </div>
        <a href="/auth/<%=product.seller.username%>" class="w-100 mb-2">
          <img
            src="/files/<%= product.seller.avatar.filename %>"
            class="d-inline-block mr-2 rounded-circle"
            style="width: 40px;"
            alt="<%= product.seller.avatar.fileID %>"
          />
          <h5 class="mt-2 text-capitalize d-inline-block">
            <%= product.seller.name %>
          </h5>
        </a>
        <% if (user) { %> <%- include('../includes/add-to-cart.ejs', { product})
        %> <% } %>
        <br />
        <hr class="mt-0" />
        <div class="p-2">
          <%- product.body %>
        </div>
      </div>
    </div>
  </div>
  <div class="col-sm-12 col-md-11 col-lg-10">
    <div class="card border-light mb-3">
      <h4 class="card-header">Reviews</h4>
      <div class="card-body">
        <div class="list-group">
          <%- include('../includes/add-review') %> <% const reviews =
          product.reviews.reverse() %> <% for( let i = 0; i < reviews.length;
          i++ ) { const review = reviews[i] %>
          <div><%- include('../includes/review', {review}) %></div>
          <%}%>
        </div>
      </div>
    </div>
  </div>
</div>
<%-include('../includes/footer.ejs') %>
